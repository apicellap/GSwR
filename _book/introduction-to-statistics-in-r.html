<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 5 Introduction to Statistics in R | A Guide to Getting Started with R</title>
<meta name="author" content="Pete Apicella">
<meta name="generator" content="bookdown 0.27 with bs4_book()">
<meta property="og:title" content="Chapter 5 Introduction to Statistics in R | A Guide to Getting Started with R">
<meta property="og:type" content="book">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 5 Introduction to Statistics in R | A Guide to Getting Started with R">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
<meta name="description" content='install.packages("ggplot2", repos = "https://cran.us.r-project.org") install.packages("dplyr", repos = "https://cran.us.r-project.org") install.packages("ggfortify", repos =...'>
<meta property="og:description" content='install.packages("ggplot2", repos = "https://cran.us.r-project.org") install.packages("dplyr", repos = "https://cran.us.r-project.org") install.packages("ggfortify", repos =...'>
<meta name="twitter:description" content='install.packages("ggplot2", repos = "https://cran.us.r-project.org") install.packages("dplyr", repos = "https://cran.us.r-project.org") install.packages("ggfortify", repos =...'>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">A Guide to Getting Started with R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">About</a></li>
<li><a class="" href="getting-acqainted-with-r.html"><span class="header-section-number">1</span> Getting Acqainted with R</a></li>
<li><a class="" href="getting-data-into-r.html"><span class="header-section-number">2</span> Getting Data into R</a></li>
<li><a class="" href="data-management-and-manipulation.html"><span class="header-section-number">3</span> Data Management and Manipulation</a></li>
<li><a class="" href="visualizing-your-data.html"><span class="header-section-number">4</span> Visualizing your data</a></li>
<li><a class="active" href="introduction-to-statistics-in-r.html"><span class="header-section-number">5</span> Introduction to Statistics in R</a></li>
<li><a class="" href="advancing-statistics-in-r.html"><span class="header-section-number">6</span> Advancing Statistics in R</a></li>
<li><a class="" href="getting-started-with-generalized-linear-models.html"><span class="header-section-number">7</span> Getting Started with Generalized Linear Models</a></li>
<li><a class="" href="chapter-8-pimping-your-plots.html"><span class="header-section-number">8</span> Chapter 8: Pimping Your Plots</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/rstudio/bookdown-demo">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="introduction-to-statistics-in-r" class="section level1" number="5">
<h1>
<span class="header-section-number">5</span> Introduction to Statistics in R<a class="anchor" aria-label="anchor" href="#introduction-to-statistics-in-r"><i class="fas fa-link"></i></a>
</h1>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"ggplot2"</span>,  repos <span class="op">=</span> <span class="st">"https://cran.us.r-project.org"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"dplyr"</span>,  repos <span class="op">=</span> <span class="st">"https://cran.us.r-project.org"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"ggfortify"</span>,  repos <span class="op">=</span> <span class="st">"https://cran.us.r-project.org"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sinhrks/ggfortify">ggfortify</a></span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">urlfile05a</span><span class="op">=</span><span class="st">"https://raw.githubusercontent.com/apicellap/data/main/ladybirds_morph_colour.csv"</span>
<span class="va">lady</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/connections.html">url</a></span><span class="op">(</span><span class="va">urlfile05a</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">lady</span><span class="op">)</span></code></pre></div>
<pre><code>##   Habitat Site morph_colour number
## 1   Rural   R1        black     10
## 2   Rural   R2        black      3
## 3   Rural   R3        black      4
## 4   Rural   R4        black      7
## 5   Rural   R5        black      6
## 6   Rural   R1          red     15</code></pre>
<p>View data structure:</p>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">lady</span><span class="op">)</span></code></pre></div>
<pre><code>## 'data.frame':    20 obs. of  4 variables:
##  $ Habitat     : chr  "Rural" "Rural" "Rural" "Rural" ...
##  $ Site        : chr  "R1" "R2" "R3" "R4" ...
##  $ morph_colour: chr  "black" "black" "black" "black" ...
##  $ number      : int  10 3 4 7 6 15 18 9 12 16 ...</code></pre>
<div id="chi2-contingency-table-analysis" class="section level2" number="5.1">
<h2>
<span class="header-section-number">5.1</span> <span class="math inline">\(\chi\)</span><span class="math inline">\(^{2}\)</span> contingency table analysis<a class="anchor" aria-label="anchor" href="#chi2-contingency-table-analysis"><i class="fas fa-link"></i></a>
</h2>
<p>Create new dataframe, totals:</p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">totals</span> <span class="op">&lt;-</span> <span class="va">lady</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co">#working with this dataframe</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Habitat</span>, <span class="va">morph_colour</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co">#we want to represent these groups in the dataframe</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>total.number <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">number</span><span class="op">)</span><span class="op">)</span> <span class="co">#add up the numbers of each group using the new object total.number</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by 'Habitat'. You can override using the
## `.groups` argument.</code></pre>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">totals</span></code></pre></div>
<pre><code>## # A tibble: 4 × 3
## # Groups:   Habitat [2]
##   Habitat    morph_colour total.number
##   &lt;chr&gt;      &lt;chr&gt;               &lt;int&gt;
## 1 Industrial black                 115
## 2 Industrial red                    85
## 3 Rural      black                  30
## 4 Rural      red                    70</code></pre>
<p>Create bar chart:</p>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">base_plot</span><span class="op">&lt;-</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">totals</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Habitat</span>, y<span class="op">=</span><span class="va">total.number</span>,
                  fill <span class="op">=</span> <span class="va">morph_colour</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co">#fill is used when there is something like a bar that can be filled with color </span>
                                          <span class="co">#if this were color = morph_colour, then the argument would affect the bar's outline</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>
    stat <span class="op">=</span> <span class="st">'identity'</span>, <span class="co">#this tells ggplot not to calculate anything from the data and just display the data as they are in the dataframe</span>
    position <span class="op">=</span> <span class="st">'dodge'</span> <span class="co">#this is request to put the two bars in each Habitat group next to each other </span>
                       <span class="co">#if it's not used, a stacked barplot would be printed </span>
  <span class="op">)</span> 
<span class="va">base_plot</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/bar-graph-05-1.png" width="672"></div>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">base_plot</span> <span class="op">+</span>   
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>black <span class="op">=</span> <span class="st">"black"</span>, red <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">)</span> <span class="co">#the text in "" are the colors we are instructing R to fill the bars with </span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/new-colors-base-plot-05-1.png" width="672"></div>
<ul>
<li>Null hypothesis: there is no association between the color of the birds and their habitat
<ul>
<li>My opinion: data suggest that there is a higher proportion of colored birds in the industrial habitat. We should reject the null hypothesis (pre-stats)</li>
<li>to rigorously test this, a chi-squared test must be performed</li>
</ul>
</li>
</ul>
</div>
<div id="making-the-chi2-test" class="section level2" number="5.2">
<h2>
<span class="header-section-number">5.2</span> Making the <span class="math inline">\(\chi\)</span><span class="math inline">\(^{2}\)</span> Test<a class="anchor" aria-label="anchor" href="#making-the-chi2-test"><i class="fas fa-link"></i></a>
</h2>
<p>Use <code><a href="https://rdrr.io/r/stats/xtabs.html">xtabs()</a></code> function to generate a contingency table:</p>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lady.mat</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/xtabs.html">xtabs</a></span><span class="op">(</span>                     <span class="co">#function converts dataframe into a matrix, which is different from a dataframe</span>
                  <span class="va">number</span> <span class="op">~</span> <span class="va">Habitat</span> <span class="op">+</span> <span class="va">morph_colour</span>, <span class="co">#cross-tabulate the number of column counts in the dataframe by the Habitat and morph_colour variables</span>
                 data <span class="op">=</span> <span class="va">lady</span><span class="op">)</span> 
<span class="va">lady.mat</span></code></pre></div>
<pre><code>##             morph_colour
## Habitat      black red
##   Industrial   115  85
##   Rural         30  70</code></pre>
<p>Perform a <span class="math inline">\(\chi\)</span><span class="math inline">\(^{2}\)</span> test on the matrix:</p>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lady.chi</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span><span class="va">lady.mat</span><span class="op">)</span> <span class="co">#chi squared test function performed on matrix </span>
<span class="va">lady.chi</span></code></pre></div>
<pre><code>## 
##  Pearson's Chi-squared test with Yates' continuity correction
## 
## data:  lady.mat
## X-squared = 19.103, df = 1, p-value = 1.239e-05</code></pre>
<ul>
<li>the p value is 0.00001239 - this is the probability that the pattern arose by chance.
<ul>
<li>It is lower than 0.05, so we can reject the null hypothesis</li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">lady.chi</span><span class="op">)</span> <span class="co">#can examine all of the parts of the test mechanics </span></code></pre></div>
<pre><code>## [1] "statistic" "parameter" "p.value"   "method"    "data.name" "observed" 
## [7] "expected"  "residuals" "stdres"</code></pre>
</div>
<div id="two-sample-t-test" class="section level2" number="5.3">
<h2>
<span class="header-section-number">5.3</span> Two-sample t-test<a class="anchor" aria-label="anchor" href="#two-sample-t-test"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>The two-sample t-test compares the means of two groups of numeric values</li>
<li>It is appropriate when the sample sizes of these two groups is small</li>
<li>The analysis makes the following assumptions about the data:
<ul>
<li>The data are normally distributed</li>
<li>The variances of the data are equivalent</li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">urlfile05b</span><span class="op">=</span><span class="st">"https://raw.githubusercontent.com/apicellap/data/main/ozone.csv"</span>
<span class="va">ozone</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/connections.html">url</a></span><span class="op">(</span><span class="va">urlfile05b</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://dplyr.tidyverse.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">ozone</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 20
## Columns: 3
## $ Ozone           &lt;dbl&gt; 61.7, 64.0, 72.4, 56.8, 52.4, 44.8, 70.4, 67.6, 68.8, …
## $ Garden.location &lt;chr&gt; "West", "West", "West", "West", "West", "West", "West"…
## $ Garden.ID       &lt;chr&gt; "G1", "G2", "G3", "G4", "G5", "G6", "G7", "G8", "G9", …</code></pre>
<div id="the-first-step-plot-your-data" class="section level3" number="5.3.1">
<h3>
<span class="header-section-number">5.3.1</span> The first step: Plot your data<a class="anchor" aria-label="anchor" href="#the-first-step-plot-your-data"><i class="fas fa-link"></i></a>
</h3>
<p>Create histograms of the data, by Garden.location variable:</p>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">ozone</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Ozone</span><span class="op">)</span><span class="op">)</span><span class="op">+</span> <span class="co">#since this is a histogram, x must be a continuous variable; cannot be categorical </span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth<span class="op">=</span><span class="fl">10</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Garden.location</span>, <span class="co">#Divide data up into groups by this variable </span>
            ncol<span class="op">=</span><span class="fl">1</span> <span class="op">)</span> <span class="op">+</span>  <span class="co">#stacks the graphs on top of each other - 1 column </span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/ozone-histogram-05-1.png" width="672"></div>
<ul>
<li>graph shows that assumptions of normality and equality of variance are met
<ul>
<li>R has functions to evaluate these aspects more rigorously too</li>
</ul>
</li>
</ul>
<p>Count the number of observations when variable is ‘East’:</p>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">ozone</span>, <span class="va">Garden.location</span> <span class="op">==</span> <span class="st">"East"</span><span class="op">)</span><span class="op">)</span> 
<span class="va">x</span></code></pre></div>
<pre><code>## [1] 10</code></pre>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">summary</span><span class="op">&lt;-</span><span class="va">ozone</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Garden.location</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Ozone</span><span class="op">)</span>, SE <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">Ozone</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>
<span class="va">summary</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##   Garden.location  mean    SE
##   &lt;chr&gt;           &lt;dbl&gt; &lt;dbl&gt;
## 1 East             77.3  2.49
## 2 West             61.3  2.87</code></pre>
<p>Plot the ozone data as a barplot:</p>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">OzBrP</span><span class="op">&lt;-</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">summary</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Garden.location</span>, y <span class="op">=</span> <span class="va">mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co">#x defined as grazing treatment, y as fruit production</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Garden.location</span>, ymin<span class="op">=</span><span class="va">mean</span> <span class="op">-</span><span class="va">SE</span>, ymax<span class="op">=</span><span class="va">mean</span><span class="op">*</span><span class="fl">1</span><span class="op">+</span><span class="va">SE</span>, width<span class="op">=</span><span class="fl">.2</span><span class="op">)</span>,
                                            position <span class="op">=</span> <span class="st">'dodge'</span><span class="op">)</span>
<span class="va">OzBrP</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/ozone-barplot-05-1.png" width="672"></div>
<p>Plot the ozone data as a boxplot:</p>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">OzBxP</span> <span class="op">&lt;-</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">ozone</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Garden.location</span>, y <span class="op">=</span> <span class="va">Ozone</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">OzBxP</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/ozone-boxplot-05-1.png" width="672"></div>
<ul>
<li>null hypothesis: there is no difference in ozone levels between the East and West garden locations</li>
<li>my opinion based on the boxplot - reject the null hypothesis</li>
</ul>
</div>
<div id="two-sample-t-test-analysis" class="section level3" number="5.3.2">
<h3>
<span class="header-section-number">5.3.2</span> Two sample t-test analysis<a class="anchor" aria-label="anchor" href="#two-sample-t-test-analysis"><i class="fas fa-link"></i></a>
</h3>
<p>Perform two sample t-test on the ozone dataset:</p>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Ozone</span> <span class="op">~</span> <span class="va">Garden.location</span>, <span class="co">#expression means do ozone levels vary as a function of location? That's how the ~ reads </span>
       data <span class="op">=</span> <span class="va">ozone</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  Ozone by Garden.location
## t = 4.2363, df = 17.656, p-value = 0.0005159
## alternative hypothesis: true difference in means between group East and group West is not equal to 0
## 95 percent confidence interval:
##   8.094171 24.065829
## sample estimates:
## mean in group East mean in group West 
##              77.34              61.26</code></pre>
<ul>
<li>the default of this two sample t-test is the Welch’s version
<ul>
<li>In Welch version, the assumption about equal variance is relaxed and allows that you do not have to test for equal variance</li>
</ul>
</li>
<li>The GSwR authors suggest not testing for equal variance</li>
<li>note regarding the Confidence interval (CI): the line about the 95% CI is 8.1-24.1. Since this range does not include 0 says that the means are statistically different from each other. This is congruent with the p value of the t-test</li>
</ul>
</div>
</div>
<div id="linear-models" class="section level2" number="5.4">
<h2>
<span class="header-section-number">5.4</span> Linear models<a class="anchor" aria-label="anchor" href="#linear-models"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>Linear models are a class of analyses that include regression, multiple regression, ANOVA, and ANCOVA
<ul>
<li>they are centered around a similiar framework of ideas such as a common set of assumptions about the data like the idea that the data are normally distributed</li>
</ul>
</li>
</ul>
</div>
<div id="simple-linear-regression" class="section level2" number="5.5">
<h2>
<span class="header-section-number">5.5</span> Simple linear regression<a class="anchor" aria-label="anchor" href="#simple-linear-regression"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>This section focuses on a dataset that compares plant growth rates to soil moisture content</li>
<li>The response (dependent) variable is that of plant growth rate</li>
<li>Plant growth rate is plotted against the explanatory (independent) variable, soil moisture content
<ul>
<li>This variable is a continuous, numeric variable which does not have categories</li>
</ul>
</li>
</ul>
<p>Read and view structure of the data:</p>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">urlfile05c</span><span class="op">=</span><span class="st">"https://raw.githubusercontent.com/apicellap/data/main/plant.growth.rate.csv"</span>
<span class="va">plant_gr</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/connections.html">url</a></span><span class="op">(</span><span class="va">urlfile05c</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://dplyr.tidyverse.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">plant_gr</span><span class="op">)</span> <span class="co">#two continuous (numeric) variables. they have no categories </span></code></pre></div>
<pre><code>## Rows: 50
## Columns: 2
## $ soil.moisture.content &lt;dbl&gt; 0.4696876, 0.5413106, 1.6979915, 0.8255799, 0.85…
## $ plant.growth.rate     &lt;dbl&gt; 21.31695, 27.03072, 38.98937, 30.19529, 37.06547…</code></pre>
<div id="getting-and-plotting-the-data" class="section level3" number="5.5.1">
<h3>
<span class="header-section-number">5.5.1</span> Getting and plotting the data<a class="anchor" aria-label="anchor" href="#getting-and-plotting-the-data"><i class="fas fa-link"></i></a>
</h3>
<p>Plot the plant growth (pg) data:</p>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">plant_gr</span>,
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">soil.moisture.content</span>, y<span class="op">=</span><span class="va">plant.growth.rate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Plant Growth Rate (mm/week)"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/pg-scatterplot-05-1.png" width="672"></div>
<ul>
<li>Plot shows that there is a probably a positive linear relationship between the two variables
<ul>
<li>There is a slope of about 15 mm/week</li>
<li>preliminary analysis: probably will reject the null hypothesis that soil moisture does not affect plant growth</li>
</ul>
</li>
</ul>
</div>
<div id="making-a-simple-linear-regression-happen" class="section level3" number="5.5.2">
<h3>
<span class="header-section-number">5.5.2</span> Making a simple linear regression happen<a class="anchor" aria-label="anchor" href="#making-a-simple-linear-regression-happen"><i class="fas fa-link"></i></a>
</h3>
<p>Create a linear model:</p>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_pgr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">plant.growth.rate</span> <span class="op">~</span> <span class="va">soil.moisture.content</span>, data <span class="op">=</span> <span class="va">plant_gr</span><span class="op">)</span> <span class="co">#plant growth rate is a function of soil moisture content</span>
<span class="va">model_pgr</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = plant.growth.rate ~ soil.moisture.content, data = plant_gr)
## 
## Coefficients:
##           (Intercept)  soil.moisture.content  
##                 19.35                  12.75</code></pre>
</div>
<div id="assumptions-first" class="section level3" number="5.5.3">
<h3>
<span class="header-section-number">5.5.3</span> Assumptions first<a class="anchor" aria-label="anchor" href="#assumptions-first"><i class="fas fa-link"></i></a>
</h3>
<p>Check assumptions with ggfortify:</p>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">model_pgr</span>, 
         smooth.colour <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/assumption-check-05-1.png" width="672"></div>
<ul>
<li>ggfortify plots:
<ul>
<li>Top left - informs us on whether the line is an appropriate fit to the data; flat line means model is a good fit. Humps/valleys -&gt; poor fit</li>
<li>Top right - dots = residuals; dashes line = expectation under normal distribution. Better tool than histogram to assess normal distribution</li>
<li>Bottom left - evaluates assumption of equal variance. linear models assume that variance is constant over all predicted values of the response variable. There should be no pattern</li>
<li>Bottom right - evaluates leverage. Used to detect influential datapoints that will shift the gradient more than expected + also for outliers</li>
</ul>
</li>
<li>null hypothesis: soil moisture has no effect on plant growth</li>
</ul>
</div>
<div id="now-the-interpretation" class="section level3" number="5.5.4">
<h3>
<span class="header-section-number">5.5.4</span> Now the interpretation<a class="anchor" aria-label="anchor" href="#now-the-interpretation"><i class="fas fa-link"></i></a>
</h3>
<p>Produce a sum of squares table:</p>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">model_pgr</span><span class="op">)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: plant.growth.rate
##                       Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
## soil.moisture.content  1 2521.15 2521.15  156.08 &lt; 2.2e-16 ***
## Residuals             48  775.35   16.15                      
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<ul>
<li>Output:</li>
<li>Large F value indicates that error variance is small relative to the variance attributed to the explanatory variable
<ul>
<li>This leads to the tiny p value.
<ul>
<li>Both are good indications that the effect seen in the data isn’t the result of chance</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Produce a summary table:</p>
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_pgr</span><span class="op">)</span> </code></pre></div>
<pre><code>## 
## Call:
## lm(formula = plant.growth.rate ~ soil.moisture.content, data = plant_gr)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -8.9089 -3.0747  0.2261  2.6567  8.9406 
## 
## Coefficients:
##                       Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)             19.348      1.283   15.08   &lt;2e-16 ***
## soil.moisture.content   12.750      1.021   12.49   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 4.019 on 48 degrees of freedom
## Multiple R-squared:  0.7648, Adjusted R-squared:  0.7599 
## F-statistic: 156.1 on 1 and 48 DF,  p-value: &lt; 2.2e-16</code></pre>
<ul>
<li>produces table of estimates of the coefficients of the line that is the model</li>
<li>the slope that is associated with the explanatory variable (soil moisture) - the values of which are associated with the differences in plant growth rate</li>
</ul>
<p>Superimpose linear model onto plot:</p>
<div class="sourceCode" id="cb123"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">plant_gr</span>,
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">soil.moisture.content</span>, y<span class="op">=</span><span class="va">plant.growth.rate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">'lm'</span><span class="op">)</span> <span class="op">+</span> <span class="co">#put a linear-model fitted line and the standard error of the fit using flash transparent gray onto graph </span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Plant Growth Rate (mm/week)"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula 'y ~ x'</code></pre>
<div class="inline-figure"><img src="_main_files/figure-html/linear-model-on-plot-05-1.png" width="672"></div>
</div>
</div>
<div id="analysis-of-variance-the-one-way-anova" class="section level2" number="5.6">
<h2>
<span class="header-section-number">5.6</span> Analysis of variance: the one-way ANOVA<a class="anchor" aria-label="anchor" href="#analysis-of-variance-the-one-way-anova"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>the one-way ANOVA is similiar to the previous example and the two-sample t-test with one key difference:
<ul>
<li>the explanatory variable in the one-way ANOVA is a categorical variable (factor)</li>
</ul>
</li>
<li>waterflea dataset - we ask:
<ul>
<li>whether parasites alter waterflea growth rates</li>
<li>whether each of three parasittes reduces growth rates relative to a control in which there was no parasite</li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb125"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">urlfile05d</span><span class="op">=</span><span class="st">"https://raw.githubusercontent.com/apicellap/data/main/Daphniagrowth.csv"</span>
<span class="va">daphnia</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/connections.html">url</a></span><span class="op">(</span><span class="va">urlfile05d</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://dplyr.tidyverse.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">daphnia</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 40
## Columns: 3
## $ parasite    &lt;chr&gt; "control", "control", "control", "control", "control", "co…
## $ rep         &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 1, 2, 3, 4, 5, 6, 7, 8, 9, …
## $ growth.rate &lt;dbl&gt; 1.0747092, 1.2659016, 1.3151563, 1.0757519, 1.1967619, 1.3…</code></pre>
<p>Plot daphnia data:</p>
<div class="sourceCode" id="cb127"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">daphnia</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">parasite</span>, y<span class="op">=</span><span class="va">growth.rate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="co">#flips the orientation of the graph 90˚ to the right </span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/daphnia-boxplot-05-1.png" width="672"></div>
<ul>
<li>Visualization takeaways:
<ul>
<li>There is substantial variation among the parasite groups</li>
<li>The control group has the highest growth rate</li>
<li>There is likely to be an overall effect of parasites on growth rate</li>
<li>There may be an order in the impacts different parasites have on growth rates: P. ramosa &lt; M. bicuspidata &lt; P. perplexa</li>
</ul>
</li>
</ul>
<p>Create a model:</p>
<div class="sourceCode" id="cb128"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_grow</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">growth.rate</span> <span class="op">~</span> <span class="va">parasite</span>, data <span class="op">=</span> <span class="va">daphnia</span><span class="op">)</span>
<span class="va">model_grow</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = growth.rate ~ parasite, data = daphnia)
## 
## Coefficients:
##                       (Intercept)  parasiteMetschnikowia bicuspidata  
##                            1.2139                            -0.4128  
##      parasitePansporella perplexa           parasitePasteuria ramosa  
##                           -0.1376                            -0.7317</code></pre>
<p>Check the assumptions:</p>
<div class="sourceCode" id="cb130"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">model_grow</span>, 
         smooth.colour <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/assumption-check-dph-05-1.png" width="672"></div>
<ul>
<li>assumption-checking plots:
<ul>
<li>The figures suggest that the assumptions are fine</li>
<li>Even the upper right plot, the Q-Q plot, is within the bounds of expected variation</li>
</ul>
</li>
</ul>
<p>Produce anova table for model:</p>
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">model_grow</span><span class="op">)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: growth.rate
##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## parasite   3 3.1379 1.04597  32.325 2.571e-10 ***
## Residuals 36 1.1649 0.03236                      
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<ul>
<li>For a one-way anova, the null hypothesis is that all of the groups come from populations with (statistically) the same mean
<ul>
<li>The F-value quantifies how likely this is to be true
<ul>
<li>F value is the ratio between the between group variation: within group variation
<ul>
<li>A large F value means that the between group variation is much larger</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb133"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_grow</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = growth.rate ~ parasite, data = daphnia)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.41930 -0.09696  0.01408  0.12267  0.31790 
## 
## Coefficients:
##                                   Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                        1.21391    0.05688  21.340  &lt; 2e-16 ***
## parasiteMetschnikowia bicuspidata -0.41275    0.08045  -5.131 1.01e-05 ***
## parasitePansporella perplexa      -0.13755    0.08045  -1.710   0.0959 .  
## parasitePasteuria ramosa          -0.73171    0.08045  -9.096 7.34e-11 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.1799 on 36 degrees of freedom
## Multiple R-squared:  0.7293, Adjusted R-squared:  0.7067 
## F-statistic: 32.33 on 3 and 36 DF,  p-value: 2.571e-10</code></pre>
<ul>
<li>Output:</li>
<li>table of coefficients:
<ul>
<li>What is labelled as ‘(Intercept)’ is the control</li>
<li>R tends to list things in alphabetical order
<ul>
<li>Of the levels of the explanatory variable, ‘control’ is the first alphabetically</li>
<li>In this context, we can assume that (Intercept) refers to the first level in alphabetical order - control - in this case</li>
</ul>
</li>
<li>Treatment contrasts report the <em>differences</em> between the reference level (the control in this case) and the other levels
<ul>
<li>So -0.41275 is the difference between the control level and the parasiteMetschnikowia bicuspidata level</li>
<li>In other words, the differences are the distances between the colored diamonds and the dotted black line in figure 6.1 below</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Determine the means for each level:</p>
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sumDat</span> <span class="op">&lt;-</span> <span class="va">daphnia</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">parasite</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>meanGR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">growth.rate</span><span class="op">)</span><span class="op">)</span>
<span class="va">sumDat</span></code></pre></div>
<pre><code>## # A tibble: 4 × 2
##   parasite                  meanGR
##   &lt;chr&gt;                      &lt;dbl&gt;
## 1 control                    1.21 
## 2 Metschnikowia bicuspidata  0.801
## 3 Pansporella perplexa       1.08 
## 4 Pasteuria ramosa           0.482</code></pre>
<p>Manually determine the difference between control and other levels:</p>
<div class="sourceCode" id="cb137"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">0.8011541</span>   <span class="op">-</span><span class="fl">1.2139088</span>  </code></pre></div>
<pre><code>## [1] -0.4127547</code></pre>
<div class="sourceCode" id="cb139"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">1.0763551</span> <span class="op">-</span> <span class="fl">1.2139088</span></code></pre></div>
<pre><code>## [1] -0.1375537</code></pre>
<div class="sourceCode" id="cb141"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">0.4822030</span> <span class="op">-</span> <span class="fl">1.2139088</span></code></pre></div>
<pre><code>## [1] -0.7317058</code></pre>
<div class="sourceCode" id="cb143"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">daphnia</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">parasite</span>, y<span class="op">=</span><span class="va">growth.rate</span>, color <span class="op">=</span> <span class="va">parasite</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sumDat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span> x <span class="op">=</span> <span class="va">parasite</span>, y <span class="op">=</span> <span class="va">meanGR</span><span class="op">)</span>, shape <span class="op">=</span> <span class="fl">18</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">sumDat</span><span class="op">$</span><span class="va">meanGR</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
             lwd<span class="op">=</span><span class="fl">1</span>,
             linetype <span class="op">=</span> <span class="st">'dotted'</span>,
             colour<span class="op">=</span><span class="st">"black"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">sumDat</span><span class="op">$</span><span class="va">meanGR</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
             lwd<span class="op">=</span><span class="fl">1</span>,
             linetype <span class="op">=</span> <span class="st">'dotted'</span>,
             colour<span class="op">=</span><span class="st">"black"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> </code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:means-plot-05"></span>
<img src="_main_files/figure-html/means-plot-05-1.png" alt="\label{fig:figs}Daphnia Treatment Differences" width="672"><p class="caption">
Figure 5.1: Daphnia Treatment Differences
</p>
</div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="visualizing-your-data.html"><span class="header-section-number">4</span> Visualizing your data</a></div>
<div class="next"><a href="advancing-statistics-in-r.html"><span class="header-section-number">6</span> Advancing Statistics in R</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#introduction-to-statistics-in-r"><span class="header-section-number">5</span> Introduction to Statistics in R</a></li>
<li><a class="nav-link" href="#chi2-contingency-table-analysis"><span class="header-section-number">5.1</span> \(\chi\)\(^{2}\) contingency table analysis</a></li>
<li><a class="nav-link" href="#making-the-chi2-test"><span class="header-section-number">5.2</span> Making the \(\chi\)\(^{2}\) Test</a></li>
<li>
<a class="nav-link" href="#two-sample-t-test"><span class="header-section-number">5.3</span> Two-sample t-test</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#the-first-step-plot-your-data"><span class="header-section-number">5.3.1</span> The first step: Plot your data</a></li>
<li><a class="nav-link" href="#two-sample-t-test-analysis"><span class="header-section-number">5.3.2</span> Two sample t-test analysis</a></li>
</ul>
</li>
<li><a class="nav-link" href="#linear-models"><span class="header-section-number">5.4</span> Linear models</a></li>
<li>
<a class="nav-link" href="#simple-linear-regression"><span class="header-section-number">5.5</span> Simple linear regression</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#getting-and-plotting-the-data"><span class="header-section-number">5.5.1</span> Getting and plotting the data</a></li>
<li><a class="nav-link" href="#making-a-simple-linear-regression-happen"><span class="header-section-number">5.5.2</span> Making a simple linear regression happen</a></li>
<li><a class="nav-link" href="#assumptions-first"><span class="header-section-number">5.5.3</span> Assumptions first</a></li>
<li><a class="nav-link" href="#now-the-interpretation"><span class="header-section-number">5.5.4</span> Now the interpretation</a></li>
</ul>
</li>
<li><a class="nav-link" href="#analysis-of-variance-the-one-way-anova"><span class="header-section-number">5.6</span> Analysis of variance: the one-way ANOVA</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/rstudio/bookdown-demo/blob/master/05_intro-to-stats.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/rstudio/bookdown-demo/edit/master/05_intro-to-stats.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>A Guide to Getting Started with R</strong>" was written by Pete Apicella. It was last built on 2022-07-18.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
